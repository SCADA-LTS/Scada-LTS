<!--
    Mango - Open Source M2M - http://mango.serotoninsoftware.com
    Copyright (C) 2006-2011 Serotonin Software Technologies Inc.
    @author Matthew Lohbihler
    
    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see http://www.gnu.org/licenses/.
 -->

<h1>Обзор</h1>
<p>Источник данных Modbus IP используется для сбора данных с оборудования Modbus, доступного через IP-четь. Оборудование может находиться в локальной сети или в Интранет-сети, а также может быт где угодно в сети Интернет. Это источник данных, работающий в режиме опроса. </p>

<h1>Конфигурация</h1>
<p>
  Каждый источник данных должен иметь произвольно заданное Имя. Период обновления определяет частоту опросов оборудования MODBUS. Если поставить флажок в окошке Отсчет, то запуск источника данных будет происходить с задержкой, равной «округленному» значению времени. (например, если период опроса равен 10 секундам, то запросы будут отправляться на 10-ой секунде, затем на 20-ой секунде и т.д.) В противном случае опрос будет начинаться без задержки. Значения полей Время ожидания и Повторы определяют поведение системы в случае ошибки опроса. Источник данных ожидает ответа от оборудования в течение заданного времени ожидания (в миллисекундах). Если ответа нет, запрос будет повторяться заданное в поле Повторы количество раз.</p>
<p>Флажок <strong> Только непрерывные пакеты</strong> можно использовать для того, чтобы протокол MODBUS не пытался оптимизировать запросы, содержащие несопоставимые значения, в один запрос. Если проставить флажок в этом окне, программа будет отправлять запросы на группы значений, только если эти значения образуют непрерывную цепочку пробелов.</p>
<p>Флажок в окошке <strong>Создать Мониторы подчиненных устройств</strong> задает автоматическое создание источником данных мониторов подчиненных устройств. Монитор подчиненного устройства – это двоичный объект, который показывает текущее состояние подчиненного устройства. Если опрос устройства не выполнен вследствие окончания времени ожидания или ошибки, подчиненное устройство считается не подключенным к сети. Эти объекты могут использоваться для управления так же, как и другие объекты. </p>
<p>Поля <strong>Максимальное число битов чтения</strong>, <strong>Максимальное число регистров чтения</strong>, <strong>Максимальное число регистров записи</strong> позволяют задать размер пакетных запросов. В технической характеристике MODBUS указаны предопределенные по умолчанию значения этих параметров, но некоторые виды оборудования могут налагать свои ограничения</p>
<p>В системе поддерживается три <strong>Типа транспорта</strong>. Для выбора настроек, пожалуйста, обратитесь к документации на Ваше оборудование.</p>
<ul>
  <li>
    Установка <strong>TCP</strong> предполагает использование нового TCP сокета (разъема) для каждого опроса. (Если при открытии разъема происходит ошибка соединения, система пытается восстановить соединение заданное параметром «Повторы» количество раз. Время ожидания, используемое для соединения, зависит от стека TCP). Эту установку рекомендуется использовать, если опросы оборудования происходят не часто. </li>
  <li>Установка <strong>TCP с контролем соединения (keep-alive) </strong>позволяет создать TCP соединение при первом опросе, далее соединение продолжает оставаться открытым для использования. Если по каким-то причинам соединение прерывается, то, при необходимости, создается новое соединение. Поведение системы в случае исключительной ошибки для данной установки такое же, как для варианта TCP. Эта установка рекомендуется для большинства пользователей, так как она обеспечивает наиболее эффективное и устойчивое соединение и позволяет избежать многих трудностей с конфигурацией, свойственных UDP</li>
  <li>Установка <strong>UDP</strong> предполагает обмен UDP-пакетами. Эта установка обеспечивает наибольшую эффективность работы сети, но обычно требует больше затрат на конфигурацию сети, так как и Mango, и оборудование должны быть видимы в сети (в отличие от TCP, где Mango может быть за пределами брандмауэра)</li>
</ul>

<p>Настройки <strong>Хоста</strong> и <strong>Порта</strong> задают расположение оборудования MODBUS в сети. Хост может быть задан доменным именем или IP-адресом.</p>

<h1>Сканирование узлов</h1>
<p>При помощи утилиты сканирования можно находить в сети подчиненные узлы. Эта функция проверяет подчиненные устройства от 1 до 240, направляя каждому запрос ReadExceptionStatus (Состояние ошибки чтения) (код функции 7). Если ответ получен (с учетом заданных времени ожидания и повторов), узел считается существующим. Обратите внимание, что не все оборудование поддерживает этот код функции, поэтому возможны ложные отрицательные результаты.</p>
