/******************************************
 * FUScaBR - "Funções úteis para o ScadaBR"
 * Version 2.0 - License: MIT
 ******************************************/
"use strict";fuscabr.csnippet={loadHtmlTemplate:function(){var e=fuscabr.csnippet.conf,t=document.getElementById("fuscabr-csnippet-html-select"),n=t[t.selectedIndex].value;t.disabled=!0;var c=new Event("change"),r=document.getElementById("staticPointContent");ajaxGet(e.htmlTemplatesFolder+n,function(e){r.value=e,r.dispatchEvent(c),t.disabled=!1},e.templatesLoadTimeout,function(){r.value="\x3c!-- Connection Timeout, please try again --\x3e",r.dispatchEvent(c),t.disabled=!1},function(){r.value="\x3c!-- Error! Template file not found. --\x3e",r.dispatchEvent(c),t.disabled=!1})},loadServerScriptTemplate:function(){var e=fuscabr.csnippet.conf,t=document.getElementById("fuscabr-csnippet-script-select"),n=t[t.selectedIndex].value;t.disabled=!0;var c=new Event("change"),r=document.getElementById("graphicRendererScriptScript");ajaxGet(e.serverScriptTemplatesFolder+n,function(e){r.value=e,r.dispatchEvent(c),t.disabled=!1},e.templatesLoadTimeout,function(){r.value="/* Connection Timeout, please try again */",r.dispatchEvent(c),t.disabled=!1},function(){r.value="/* Error! Template file not found. */",r.dispatchEvent(c),t.disabled=!1})},createHtmlInterface:function(){ajaxGet("resources/fuscabr/templates/internal/codeSnippetDiv.html",function(e){var t=e.replace("TEMPLATE","html"),n=document.getElementById("htmlEditor");n.innerHTML=t+n.innerHTML,n.querySelector("img").addEventListener("click",fuscabr.csnippet.loadHtmlTemplate);var c=n.querySelectorAll("*[data-i18n]");for(var r of c){var a=r.getAttribute("data-i18n");fuscabr.common.i18n.csnippet[a]&&localizeElement(r,fuscabr.common.i18n.csnippet[a])}var i=new Array;for(var r of(i.push(document.createElement("option")),fuscabr.csnippet.conf.htmlTemplates)){var s=document.createElement("option");s.value=r.file,s.innerHTML=fuscabr.common.i18n.csnippet[r.i18n]||r.desc,i.push(s)}i.sort(function(e,t){return e.innerHTML.localeCompare(t.innerHTML)});var p=document.createDocumentFragment();for(var r in i)p.appendChild(i[r]);document.getElementById("fuscabr-csnippet-html-select").appendChild(p),document.querySelector("#staticEditorPopup td[align='right']").addEventListener("click",fuscabr.csnippet.resetSelectedTemplates,!0)})},createServerScriptInterface:function(){ajaxGet("resources/fuscabr/templates/internal/codeSnippetDiv.html",function(e){var t=e.replace("TEMPLATE","script"),n=document.getElementById("graphicRenderer_script");n.innerHTML=n.innerHTML.replace("<br>",t),n.querySelector("img").addEventListener("click",fuscabr.csnippet.loadServerScriptTemplate);var c=n.querySelectorAll("*[data-i18n]");for(var r of c){var a=r.getAttribute("data-i18n");fuscabr.common.i18n.csnippet[a]&&localizeElement(r,fuscabr.common.i18n.csnippet[a])}var i=new Array;for(var r of(i.push(document.createElement("option")),fuscabr.csnippet.conf.serverScriptTemplates)){var s=document.createElement("option");s.value=r.file,s.innerHTML=fuscabr.common.i18n.csnippet[r.i18n]||r.desc,i.push(s)}i.sort(function(e,t){return e.innerHTML.localeCompare(t.innerHTML)});var p=document.createDocumentFragment();for(var r in i)p.appendChild(i[r]);document.getElementById("fuscabr-csnippet-script-select").appendChild(p),document.querySelector("#graphicRendererEditorPopup td[align='right']").addEventListener("click",fuscabr.csnippet.resetSelectedTemplates,!0)})},resetSelectedTemplates:function(){var e=document.getElementById("fuscabr-csnippet-html-select"),t=document.getElementById("fuscabr-csnippet-script-select");e.selectedIndex=0,t.selectedIndex=0},getSettings:function(){ajaxGetJson("resources/fuscabr/conf/modules/csnippet.json",function(e){fuscabr.csnippet.conf=e,fuscabr.csnippet.init()})},init:function(){fuscabr.csnippet.conf?(fuscabr.csnippet.createHtmlInterface(),fuscabr.csnippet.createServerScriptInterface()):fuscabr.csnippet.getSettings()}},fuscabr.csnippet.init();
